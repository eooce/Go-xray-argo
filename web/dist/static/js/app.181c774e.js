!function(e){function t(t){for(var a,r,i=t[0],c=t[1],l=t[2],h=0,p=[];h<i.length;h++)r=i[h],Object.prototype.hasOwnProperty.call(n,r)&&n[r]&&p.push(n[r][0]),n[r]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);for(u&&u(t);p.length;)p.shift()();return o.push.apply(o,l||[]),s()}function s(){for(var e,t=0;t<o.length;t++){for(var s=o[t],a=!0,i=1;i<s.length;i++){var c=s[i];0!==n[c]&&(a=!1)}a&&(o.splice(t--,1),e=r(r.s=s[0]))}return e}var a={},n={app:0},o=[];function r(t){if(a[t])return a[t].exports;var s=a[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=e,r.c=a,r.d=function(e,t,s){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(s,a,function(t){return e[t]}.bind(null,a));return s},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/";var i=window.webpackJsonp=window.webpackJsonp||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var u=c;o.push([0,"chunk-vendors"]),s()}({0:function(e,t,s){e.exports=s("56d7")},"0b68":function(e,t,s){"use strict";s("ad04")},"56d7":function(e,t,s){"use strict";s.r(t);s("e260"),s("e6cf"),s("cca6"),s("a79d");var a=s("2b0e"),n=(s("0fb7"),s("450d"),s("f529")),o=s.n(n),r=(s("0c67"),s("299c")),i=s.n(r),c=(s("e3ea"),s("7bc3")),l=s.n(c),u=(s("e612"),s("dd87")),h=s.n(u),p=(s("075a"),s("72aa")),d=s.n(p),f=(s("960d"),s("defb")),m=s.n(f),g=(s("bd49"),s("18ff")),v=s.n(g),b=(s("cb70"),s("b370")),w=s.n(b),y=(s("f225"),s("89a9")),I=s.n(y),S=(s("de31"),s("c69e")),k=s.n(S),C=(s("a673"),s("7b31")),T=s.n(C),_=(s("adec"),s("3d2d")),P=s.n(_),L=(s("5466"),s("ecdf")),O=s.n(L),$=(s("38a0"),s("ad41")),F=s.n($),K=(s("ae26"),s("845f")),x=s.n(K),D=(s("1951"),s("eedf")),j=s.n(D),N=(s("eca7"),s("3787")),R=s.n(N),U=(s("425f"),s("4105")),E=s.n(U),z=(s("f4f9"),s("c2cc")),A=s.n(z),H=(s("7a0f"),s("0f6c")),M=s.n(H),J=(s("a7cc"),s("df33")),W=s.n(J),q=(s("10cb"),s("f3ad")),V=s.n(q),B={install:function(e){e.use(V.a),e.use(W.a),e.use(M.a),e.use(A.a),e.use(E.a),e.use(R.a),e.use(j.a),e.use(x.a),e.use(F.a),e.use(O.a),e.use(P.a),e.use(T.a),e.use(k.a),e.use(I.a),e.use(w.a),e.use(v.a),e.use(m.a),e.use(d.a),e.use(h.a),e.use(l.a),e.use(i.a),e.prototype.$message=o.a}},G=(s("0fae"),s("b20f"),{name:"App"}),Y=(s("0b68"),s("2877")),Q=Object(Y.a)(G,(function(){var e=this._self._c;return e("div",{attrs:{id:"app"}},[e("router-view")],1)}),[],!1,null,null,null).exports,X=s("2f62"),Z=s("5530"),ee=(s("b64b"),s("a925")),te=s("4897"),se=s.n(te),ae=s("b2d6"),ne=s.n(ae),oe=s("f0d9"),re=s.n(oe);a.default.use(ee.a);var ie={en:Object(Z.a)(Object(Z.a)({},{hostTip:"please input remote host",portTip:"input port",nameTip:"please input username",inputTip:"please input ",keyTip:"please paste privateKey content",wsClose:"websocket connection disconnected!",notCloseWindows:"please do not close windows",unlockClose:"please unlock to close tab",clickSelectFile:"click to select upload file",clickSelectFolder:"click to select upload folder",uploadFinish:" upload finish"}),ne.a),zh:Object(Z.a)(Object(Z.a)({},{OK:"确定",Cancel:"取消",History:"历史记录",Lock:"锁定",Unlock:"解锁",Size:"大小",Name:"名字",Copy:"复制",Upload:"上传",Rename:"重命名",FullScreen:"全屏",Close:"关闭",CloseLeft:"关闭左边",CloseRight:"关闭右边",CloseOther:"关闭其他",CloseAll:"关闭所有",FileBrowser:"文件管理",ModifiedTime:"修改时间",Clear:"清空",Connect:"连接",password:"密码",privateKey:"密钥",hostTip:"请输入远程host地址",portTip:"请输入端口",nameTip:"请输入用户名",inputTip:"请输入",keyTip:"请粘贴私钥内容",SelectFile:"选择文件",wsClose:"websocket连接已断开!",uploadPath:"当前上传目录",uploadFinish:"上传完成",to:"到",uploading:"正在上传",notCloseWindows:"请勿关闭窗口",unlockClose:"请解锁后再来关闭",clickSelectFile:"点击选择文件",clickSelectFolder:"点击选择文件夹",uploadFile:"上传文件",uploadFolder:"上传文件夹"}),re.a)};function ce(){var e=localStorage.getItem("language");if(e)return e;for(var t=(navigator.language||navigator.browserLanguage).toLowerCase(),s=0,a=Object.keys(ie);s<a.length;s++){var n=a[s];if(t.indexOf(n)>-1)return n}return"zh"}var le=new ee.a({locale:ce(),messages:ie,silentTranslationWarn:!0});se.a.i18n((function(e,t){return le.t(e,t)}));var ue=le,he=function(){return{sshInfo:{hostname:"",username:"",port:"",password:"",command:""},sshList:Object.prototype.hasOwnProperty.call(localStorage,"sshList")?localStorage.getItem("sshList"):null,termList:[],currentTab:{},language:ce()}},pe=(s("e9c4"),s("a9e3"),s("498a"),s("313d"),s("0eb6"),s("b7ef"),s("8bd4"),{sshReq:function(e){var t={hostname:e.sshInfo.hostname,port:Number(e.sshInfo.port),username:e.sshInfo.username,logintype:e.sshInfo.privateKey&&e.sshInfo.privateKey.trim()?1:0};e.sshInfo.password&&(t.password=e.sshInfo.password),e.sshInfo.privateKey&&e.sshInfo.privateKey.trim()&&(t.privateKey=e.sshInfo.privateKey),e.sshInfo.passphrase&&(t.passphrase=e.sshInfo.passphrase);var s=JSON.stringify(t);return window.btoa(s)}}),de={SET_PASS:function(e,t){e.sshInfo.password=t},SET_LIST:function(e,t){e.sshList=t,localStorage.setItem("sshList",t)},SET_TERMLIST:function(e,t){e.termList=t},SET_SSH:function(e,t){e.sshInfo.hostname=t.hostname,e.sshInfo.port=t.port,e.sshInfo.username=t.username,void 0!==t.password&&(e.sshInfo.password=t.password),void 0!==t.command&&(e.sshInfo.command=t.command),void 0!==t.privateKey&&(e.sshInfo.privateKey=t.privateKey),void 0!==t.passphrase&&(e.sshInfo.passphrase=t.passphrase)},SET_TAB:function(e,t){e.currentTab=t},SET_LANGUAGE:function(e,t){e.language=t,localStorage.setItem("language",t)}};a.default.use(X.a);var fe=new X.a.Store({state:he,getters:pe,mutations:de,actions:{setLanguage:function(e,t){(0,e.commit)("SET_LANGUAGE",t)}}}),me=s("8c4f"),ge=(s("14d9"),s("b0c0"),s("d3b7"),s("ac1f"),s("25f0"),s("3ca3"),s("841c"),s("ddb0"),s("2b3d"),s("bf19"),s("9861"),s("88a7"),s("271a"),s("5494"),{data:function(){return{sshInfo:{hostname:"",port:"",username:"",password:"",privateKey:"",passphrase:"",command:""},privateKeyFileName:"",generatedLink:"",isDarkTheme:!1}},watch:{sshInfo:{handler:function(e){localStorage.setItem("sshInfo",JSON.stringify(e))},deep:!0}},created:function(){var e=localStorage.getItem("connectionInfo");if(e){var t=JSON.parse(e);this.sshInfo={hostname:t.hostname||"",port:t.port||"",username:t.username||"",password:t.password||"",privateKey:t.privateKey||"",passphrase:t.passphrase||"",command:t.command||""},t.privateKey&&(this.privateKeyFileName="已保存的密钥文件")}var s=localStorage.getItem("isDarkTheme");null!==s&&(this.isDarkTheme="true"===s);var a=document.createElement("link");a.rel="stylesheet",a.href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css",document.head.appendChild(a)},methods:{onConnect:function(){if(sessionStorage.removeItem("sshInfo"),this.sshInfo.hostname&&this.sshInfo.username)if(this.sshInfo.password||this.sshInfo.privateKey){this.sshInfo.privateKey&&this.sshInfo.privateKey.trim()?this.sshInfo.password="":this.sshInfo.password&&(this.sshInfo.privateKey="",this.sshInfo.passphrase="",this.privateKeyFileName="");var e={hostname:this.sshInfo.hostname,port:this.sshInfo.port||22,username:this.sshInfo.username,password:this.sshInfo.password||"",privateKey:this.sshInfo.privateKey||"",passphrase:this.sshInfo.passphrase||"",command:this.sshInfo.command||""};localStorage.setItem("connectionInfo",JSON.stringify(e));var t={hostname:encodeURIComponent(this.sshInfo.hostname),port:Number(this.sshInfo.port)||22,username:encodeURIComponent(this.sshInfo.username),command:encodeURIComponent(this.sshInfo.command||"")};this.sshInfo.privateKey&&this.sshInfo.privateKey.trim()?(sessionStorage.setItem("sshInfo",JSON.stringify(this.sshInfo)),t.useKey=1):this.sshInfo.password&&(t.password=btoa(this.sshInfo.password)),this.$router.push({path:"/terminal",query:t})}else this.$message.error("请输入密码或上传密钥！");else this.$message.error("主机和用户名不能为空！")},onReset:function(){this.sshInfo={hostname:"",port:"",username:"",password:"",command:"",privateKey:"",passphrase:""},this.privateKeyFileName="",this.generatedLink="",localStorage.removeItem("connectionInfo"),sessionStorage.removeItem("sshInfo");var e=document.querySelector('.upload-key input[type="file"]');e&&(e.value="")},onGenerateLink:function(){if(this.sshInfo.privateKey)this.$message.warning("密钥方式登录不支持生成快捷链接，请改用密码登录方式");else if(this.sshInfo.hostname&&this.sshInfo.username){var e=new URL(window.location.href);e.pathname="/terminal";var t={},s=Object(Z.a)(Object(Z.a)({},this.sshInfo),{},{port:this.sshInfo.port||22});for(var a in s)""!==s[a]&&null!==s[a]&&(t[a]="password"===a?btoa(s[a]):s[a]);e.search=new URLSearchParams(t).toString(),this.generatedLink=e.href}else this.$message.error("请填写主机、用户名和密码以生成链接！")},copyLink:function(){var e=this;this.generatedLink&&navigator.clipboard.writeText(this.generatedLink).then((function(){e.$message.success("链接已复制！")})).catch((function(t){e.$message.error("复制失败: "+t)}))},toggleTheme:function(){this.isDarkTheme=!this.isDarkTheme,localStorage.setItem("isDarkTheme",this.isDarkTheme)},handlePrivateKeyUpload:function(e){var t=this;this.sshInfo.password="";var s=new FileReader;return s.onload=function(s){t.sshInfo.privateKey=s.target.result,t.privateKeyFileName=e.name},s.readAsText(e),!1}}}),ve=(s("836a"),Object(Y.a)(ge,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"login-container",class:{"dark-theme":e.isDarkTheme}},[t("div",{staticClass:"theme-switch-wrapper"},[t("div",{staticClass:"theme-switch",on:{click:e.toggleTheme}},[t("i",{staticClass:"fas",class:e.isDarkTheme?"fa-sun":"fa-moon",staticStyle:{"margin-top":"-40px"}})])]),t("div",{staticClass:"card",staticStyle:{margin:"20px auto"}},[t("div",{staticClass:"title"},[e._v("WebSSH Console")]),t("el-form",{staticClass:"form-grid",attrs:{model:e.sshInfo,"label-position":"top"}},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"主机地址 (Hostname)"}},[t("el-input",{attrs:{placeholder:"请输入主机地址"},model:{value:e.sshInfo.hostname,callback:function(t){e.$set(e.sshInfo,"hostname",t)},expression:"sshInfo.hostname"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"端口 (Port)"}},[t("el-input",{attrs:{placeholder:"请输入端口(默认22)"},model:{value:e.sshInfo.port,callback:function(t){e.$set(e.sshInfo,"port",e._n(t))},expression:"sshInfo.port"}})],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"用户名 (Username)"}},[t("el-input",{attrs:{placeholder:"请输入用户名"},model:{value:e.sshInfo.username,callback:function(t){e.$set(e.sshInfo,"username",t)},expression:"sshInfo.username"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"密码 (Password)"}},[t("el-input",{attrs:{type:"password",placeholder:"请输入密码","show-password":""},model:{value:e.sshInfo.password,callback:function(t){e.$set(e.sshInfo,"password",t)},expression:"sshInfo.password"}})],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"私钥 (Private Key)"}},[t("el-upload",{staticClass:"upload-key",attrs:{"show-file-list":!1,"before-upload":e.handlePrivateKeyUpload,accept:".pem,.ppk,.key,.rsa,.id_rsa,.id_dsa,.txt"}},[t("div",{staticClass:"upload-flex-row"},[t("div",{staticClass:"upload-btn"},[t("i",{staticClass:"el-icon-folder-opened",staticStyle:{"margin-right":"8px"}}),e._v(" 选择文件 ")]),t("div",{staticClass:"upload-filename"},[e._v(" "+e._s(e.privateKeyFileName||"未选择私钥文件")+" ")])])])],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"密钥口令 (PIN)"}},[t("el-input",{attrs:{placeholder:"如果有设置请输入密钥口令"},model:{value:e.sshInfo.passphrase,callback:function(t){e.$set(e.sshInfo,"passphrase",t)},expression:"sshInfo.passphrase"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"初始命令 (Initial command)"}},[t("el-input",{attrs:{placeholder:"登录后要执行的命令"},model:{value:e.sshInfo.command,callback:function(t){e.$set(e.sshInfo,"command",t)},expression:"sshInfo.command"}})],1)],1)],1),t("el-row",{staticStyle:{"margin-top":"10px"},attrs:{type:"flex",justify:"center"}},[t("el-button",{attrs:{type:"danger",icon:"el-icon-refresh"},on:{click:e.onReset}},[e._v("重置输入")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-link"},on:{click:e.onGenerateLink}},[e._v("生成链接")]),t("el-button",{attrs:{type:"success"},on:{click:e.onConnect}},[t("i",{staticClass:"fas fa-terminal",staticStyle:{"margin-right":"6px"}}),e._v("连接SSH")])],1),e.generatedLink?t("el-row",{staticStyle:{"margin-top":"18px"}},[t("el-col",{attrs:{span:24}},[t("el-input",{attrs:{readonly:""},model:{value:e.generatedLink,callback:function(t){e.generatedLink=t},expression:"generatedLink"}},[t("template",{slot:"append"},[t("el-button",{attrs:{icon:"el-icon-document-copy"},on:{click:e.copyLink}})],1)],2)],1)],1):e._e()],1)],1),e._m(0)])}),[function(){var e=this._self._c;return e("div",{staticClass:"footer"},[e("a",{attrs:{href:"https://github.com/eooce/webssh",target:"_blank",rel:"noopener noreferrer"}},[this._v("WebSSH Console | Powered by eooce")])])}],!1,null,"7b651710",null).exports),be=(s("81b2"),s("c14f")),we=s("1da1");s("99af"),s("a434"),s("e9f5"),s("7d54"),s("00b4"),s("1e25"),s("159b");var ye=s("cee4").a.create({timeout:8e3,baseURL:"/",validateStatus:function(e){switch(e){case 400:o.a.error("请求出错");break;case 403:o.a.warning({message:"拒绝访问"});break;case 404:o.a.warning({message:"请求错误,未找到该资源"});break;case 500:o.a.warning({message:"服务端错误"})}return e>=200&&e<300}});ye.interceptors.response.use((function(e){return e.data}),(function(e){return void 0!==e.response||e.config&&e.config.cancelToken||o.a.error("连接服务器失败"),Promise.reject(e.response)}));var Ie=ye;function Se(e){return Ie.get("/check?sshInfo=".concat(e))}var ke=s("fcf3"),Ce=s("47d0"),Te=s("173c");s("a15b"),s("fb6a"),s("5319");var _e={name:"FileList",data:function(){return{uploadVisible:!1,fileList:[],downloadFilePath:"",currentPath:"/",selectTip:"clickSelectFile",titleTip:"uploadFile",uploadTip:"",progressPercent:0,initialRedirectDone:!1,homePath:""}},mounted:function(){this.currentPath&&"/"!==this.currentPath||this.getFileList()},computed:Object(Z.a)(Object(Z.a)({},Object(X.b)(["currentTab"])),{},{sshInfoReady:function(){return this.$store.state.sshInfo&&this.$store.state.sshInfo.hostname},uploadUrl:function(){return"".concat("".concat(location.origin),"/file/upload")},uploadData:function(){return{sshInfo:this.$store.getters.sshReq,path:this.currentPath}}}),watch:{sshInfoReady:function(e,t){e&&!t&&this.getFileList()},currentTab:function(){this.fileList=[],this.currentPath=this.currentTab&&this.currentTab.path?this.currentTab.path:"/"}},methods:{goToHome:function(){this.homePath?this.currentPath!==this.homePath&&(this.currentPath=this.homePath,this.getFileList()):this.$message.warning("主目录信息尚不可用，请刷新重试。")},openUploadDialog:function(){this.uploadTip="".concat(this.$t("uploadPath"),": ").concat(this.currentPath),this.uploadVisible=!0},handleUploadCommand:function(e){"folder"===e?(this.selectTip="clickSelectFolder",this.titleTip="uploadFolder"):(this.selectTip="clickSelectFile",this.titleTip="uploadFile"),this.openUploadDialog();var t="folder"===e;this.webkitdirectorySupported()?this.$nextTick((function(){var e=document.getElementsByClassName("el-upload__input")[0];e&&(e.webkitdirectory=t)})):t&&this.$message.warning("当前浏览器不支持")},webkitdirectorySupported:function(){return"webkitdirectory"in document.createElement("input")},beforeUpload:function(e){this.uploadTip="".concat(this.$t("uploading")," ").concat(e.name," ").concat(this.$t("to")," ").concat(this.currentPath,", ").concat(this.$t("notCloseWindows"),".."),this.uploadData.id=e.uid;var t=e.webkitRelativePath;return this.uploadData.dir=t?t.substring(0,t.lastIndexOf("/")):"",!0},uploadSuccess:function(e,t){this.uploadTip="".concat(t.name).concat(this.$t("uploadFinish"),"!")},uploadProgress:function(e,t){if(e.percent=e.percent/2,t.percentage=t.percentage/2,50===e.percent){var s=new WebSocket("".concat("http:"===location.protocol?"ws":"wss","://").concat(location.host).concat("","/file/progress?id=").concat(t.uid));s.onmessage=function(e){t.percentage=(t.size+Number(e.data))/(2*t.size)*100},s.onclose=function(){console.log(Date(),"onclose")},s.onerror=function(){console.log(Date(),"onerror")}}},nameSort:function(e,t){return e.Name>t.Name},rowClick:function(e){e.IsDir?(this.currentPath="/"===this.currentPath.charAt(this.currentPath.length-1)?this.currentPath+e.Name:this.currentPath+"/"+e.Name,this.getFileList()):(this.downloadFilePath="/"===this.currentPath.charAt(this.currentPath.length-1)?this.currentPath+e.Name:this.currentPath+"/"+e.Name,this.downloadFile())},getFileList:function(){var e=this;return Object(we.a)(Object(be.a)().m((function t(){var s;return Object(be.a)().w((function(t){for(;;)switch(t.n){case 0:return e.currentPath=e.currentPath.replace(/\\+/g,"/"),""===e.currentPath&&(e.currentPath="/"),t.n=1,a=e.currentPath,n=e.$store.getters.sshReq,Ie.get("/file/list?path=".concat(a,"&sshInfo=").concat(n));case 1:if("success"!==(s=t.v).Msg){t.n=4;break}if(s.Data.home&&(e.homePath=s.Data.home),null===s.Data.list?e.fileList=[]:e.fileList=s.Data.list,e.initialRedirectDone||!s.Data.home||"/"===s.Data.home||e.currentPath===s.Data.home){t.n=3;break}return e.initialRedirectDone=!0,e.currentPath=s.Data.home,t.n=2,e.getFileList();case 2:return t.a(2);case 3:t.n=5;break;case 4:e.fileList=[],e.$message({message:s.Msg,type:"error",duration:3e3});case 5:return t.a(2)}var a,n}),t)})))()},upDirectory:function(){if("/"!==this.currentPath){var e=this.currentPath.split("/");e=""===e[e.length-1]?e.slice(0,e.length-2):e.slice(0,e.length-1),this.currentPath=1===e.length?"/":e.join("/"),this.getFileList()}},downloadFile:function(){var e="".concat(location.origin),t="".concat(e,"/file/download?path=").concat(this.downloadFilePath,"&sshInfo=").concat(this.$store.getters.sshReq);window.open(t)}}},Pe=(s("feba"),{name:"Terminal",components:{FileList:Object(Y.a)(_e,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"file-list-wrapper"},[t("div",{staticClass:"sftp-title"},[e._v("SFTP文件管理")]),t("div",{staticClass:"file-header"},[t("el-input",{staticClass:"path-input",attrs:{size:"small",placeholder:"当前路径..."},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getFileList()}},model:{value:e.currentPath,callback:function(t){e.currentPath=t},expression:"currentPath"}}),t("el-button-group",[t("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-s-home",title:"主目录"},on:{click:function(t){return e.goToHome()}}}),t("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-arrow-up",title:"返回上级目录"},on:{click:function(t){return e.upDirectory()}}}),t("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-refresh",title:"刷新当前目录"},on:{click:function(t){return e.getFileList()}}}),t("el-dropdown",{attrs:{size:"small"},on:{click:function(t){return e.openUploadDialog()},command:e.handleUploadCommand}},[t("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-upload"}}),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{attrs:{command:"file"}},[e._v(e._s(e.$t("uploadFile")))]),t("el-dropdown-item",{attrs:{command:"folder"}},[e._v(e._s(e.$t("uploadFolder")))])],1)],1)],1)],1),t("el-dialog",{attrs:{"custom-class":"uploadContainer",title:e.$t(this.titleTip),visible:e.uploadVisible,"append-to-body":"",width:"32%"},on:{"update:visible":function(t){e.uploadVisible=t}}},[t("el-upload",{ref:"upload",attrs:{multiple:"",drag:"",action:e.uploadUrl,data:e.uploadData,"before-upload":e.beforeUpload,"on-progress":e.uploadProgress,"on-success":e.uploadSuccess}},[t("i",{staticClass:"el-icon-upload"}),t("div",{staticClass:"el-upload__text"},[e._v(e._s(e.$t(this.selectTip)))]),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(e._s(this.uploadTip))])])],1),t("el-table",{staticClass:"file-table",attrs:{data:e.fileList,height:"100%"},on:{"row-click":e.rowClick}},[t("el-table-column",{attrs:{label:e.$t("Name"),width:"140",sortable:"","sort-method":e.nameSort},scopedSlots:e._u([{key:"default",fn:function(s){return[!0===s.row.IsDir?t("p",{staticClass:"el-icon-folder",staticStyle:{color:"#0c60b5",cursor:"pointer"}},[e._v(" "+e._s(s.row.Name))]):!1===s.row.IsDir?t("p",{staticClass:"el-icon-document",staticStyle:{cursor:"pointer"}},[e._v(" "+e._s(s.row.Name))]):e._e()]}}])}),t("el-table-column",{attrs:{label:e.$t("Size"),prop:"Size",width:"80"}}),t("el-table-column",{attrs:{label:e.$t("ModifiedTime"),prop:"ModifyTime",width:"120",sortable:""}})],1)],1)}),[],!1,null,null,null).exports},data:function(){return{term:null,ws:null,resetClose:!1,ssh:null,savePass:!1,fontSize:15,isSftpVisible:!1}},mounted:function(){var e=this;this.$nextTick((function(){e.createTerm()}))},methods:{toggleSftpPanel:function(){this.isSftpVisible=!this.isSftpVisible},setSSH:function(){this.$store.commit("SET_SSH",this.ssh)},resizeTerm:function(){},createTerm:function(){var e=this,t=this.$store.state.sshInfo;if(!t||!t.hostname)return this.$message.error("无效的连接信息！正在返回登录页..."),void this.$router.push("/");var s=document.getElementById("xterm-container");if(s){var a=this.$store.getters.sshReq;this.close();var n=new Ce.FitAddon;this.term=new ke.Terminal({cursorBlink:!0,cursorStyle:"bar",cursorWidth:4,fontFamily:"DejaVu Sans Mono, monospace",fontSize:this.fontSize,theme:{background:"#000000",foreground:"#ffffff",cursor:"#ffffff",selection:"#acacac7d",blue:"#0950ee",brightBlue:"#71afff"}}),this.term.loadAddon(n),this.term.open(document.getElementById("xterm-container")),this.term.focus(),this.term.write("[1;1H[1;32m正在连接，请稍后...[0m\r\n");try{n.fit()}catch(e){}var o=this,r={timeout:5e3,intervalObj:null,stop:function(){clearInterval(this.intervalObj)},start:function(){this.intervalObj=setInterval((function(){null!==o.ws&&1===o.ws.readyState&&o.ws.send("ping")}),this.timeout)}},i="已超时关闭!";"en"===this.$store.state.language&&(i="Connection timed out!"),this.ws=new WebSocket("".concat("http:"===location.protocol?"ws":"wss","://").concat(location.host).concat("","/term?sshInfo=").concat(a,"&rows=").concat(this.term.rows,"&cols=").concat(this.term.cols,"&closeTip=").concat(i)),this.ws.onopen=function(){console.log(Date(),"onopen"),o.connected(),r.start(),o._initCmdSent=!1},this.ws.onmessage=function(e){"string"==typeof e.data&&setTimeout((function(){if(!o._initCmdSent&&o.ssh){var e=o.term;if(!e||!e.buffer||!e.buffer.active)return;var t=e.buffer.active.baseY+e.buffer.active.cursorY,s=e.buffer.active.getLine(t);if(s){var a=s.translateToString();/[>$#%]\s*$/.test(a.trimEnd())&&(o._initCmdSent=!0,o.term.write("[s[1;1H[2K[u"),o.ssh.command&&setTimeout((function(){o.ws&&1===o.ws.readyState&&o.ws.send(o.ssh.command+"\r")}),100))}}}),10)},this.ws.onclose=function(){console.log(Date(),"onclose"),o.resetClose||(o.ssh&&!e.savePass&&(e.$store.commit("SET_PASS",""),o.ssh.password=""),e.$message({message:e.$t("wsClose"),type:"warning",duration:0,showClose:!0}),e.ws=null),r.stop(),o.resetClose=!1,null!==o.ws&&1===o.ws.readyState&&o.ws.send("resize:".concat(o.term.rows,":").concat(o.term.cols))},this.ws.onerror=function(){console.log(Date(),"onerror")};var c=new Te.AttachAddon(this.ws,{bidirectional:!1});this.term.loadAddon(c),this.term.onData((function(e){o.ws&&1===o.ws.readyState&&o.ws.send(e)})),this.term.attachCustomKeyEventHandler((function(e){return!(["F5","F11","F12"].indexOf(e.key)>-1)&&(e.ctrlKey&&"v"===e.key||e.ctrlKey&&"c"===e.key&&o.term.hasSelection()?(document.execCommand("copy"),!1):void 0)}));var l="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll";s.addEventListener(l,(function(t){if(t.ctrlKey){t.preventDefault(),t.deltaY<0?o.term.setOption("fontSize",++e.fontSize):o.term.setOption("fontSize",--e.fontSize);try{n.fit()}catch(t){}null!==o.ws&&1===o.ws.readyState&&o.ws.send("resize:".concat(o.term.rows,":").concat(o.term.cols))}})),window.addEventListener("resize",(function(){try{n.fit()}catch(e){}null!==o.ws&&1===o.ws.readyState&&o.ws.send("resize:".concat(o.term.rows,":").concat(o.term.cols))}))}else console.error("Terminal container #xterm-container not found.")},connected:function(){var e=this;return Object(we.a)(Object(be.a)().m((function t(){var s,a,n,o;return Object(be.a)().w((function(t){for(;;)switch(t.n){case 0:return s=e.$store.state.sshInfo,e.ssh=Object.assign({},s),t.n=1,Se(e.$store.getters.sshReq);case 1:if("success"===(a=t.v).Msg){t.n=2;break}return t.a(2);case 2:e.savePass=a.Data.savePass;case 3:document.title=s.hostname,null===(n=e.$store.state.sshList)?n=e.savePass?'[{"hostname": "'.concat(s.hostname,'", "username": "').concat(s.username,'", "port":').concat(s.port,', "logintype":').concat(s.logintype,', "password":"').concat(s.password,'"}]'):'[{"hostname": "'.concat(s.hostname,'", "username": "').concat(s.username,'", "port":').concat(s.port,',  "logintype":').concat(s.logintype,"}]"):((o=JSON.parse(window.atob(n))).forEach((function(e,t){e.hostname===s.hostname&&o.splice(t,1)})),o.push({hostname:s.hostname,username:s.username,port:s.port,logintype:s.logintype}),e.savePass&&(o[o.length-1].password=s.password),n=JSON.stringify(o)),e.$store.commit("SET_LIST",window.btoa(n));case 4:return t.a(2)}}),t)})))()},close:function(){null!==this.ws&&(this.ws.close(),this.resetClose=!0),null!==this.term&&this.term.dispose()}},beforeDestroy:function(){this.close()}}),Le=(s("58ef"),{components:{Terminal:Object(Y.a)(Pe,(function(){var e=this._self._c;return e("div",{staticClass:"terminal-page-wrapper"},[e("div",{staticClass:"terminal-page-container"},[this._m(0),e("div",{staticClass:"file-tree",class:{"is-visible":this.isSftpVisible}},[e("FileList")],1)]),e("div",{staticClass:"terminal-footer"},[e("span",[this._v("WebSSH Console | Powered by eooce")]),this._m(1),e("button",{staticClass:"sftp-toggle-btn",attrs:{title:"文件管理"},on:{click:this.toggleSftpPanel}},[e("i",{staticClass:"fas fa-folder-open"})])])])}),[function(){var e=this._self._c;return e("div",{staticClass:"terminal-area"},[e("div",{attrs:{id:"xterm-container"}})])},function(){var e=this._self._c;return e("a",{staticClass:"github-link",attrs:{href:"https://github.com/eooce/webssh",target:"_blank",title:"GitHub"}},[e("i",{staticClass:"fab fa-github"})])}],!1,null,"21cc908b",null).exports},beforeCreate:function(){var e=this.$route.query,t=e.hostname,s=e.port,a=e.username,n=e.password,o=e.command,r=e.privateKey,i=e.passphrase,c=e.useKey;if(t&&(t=decodeURIComponent(t)),a&&(a=decodeURIComponent(a)),n)try{n=atob(n)}catch(e){n=decodeURIComponent(n)}if(o&&(o=decodeURIComponent(o)),r&&(r=decodeURIComponent(r)),i&&(i=decodeURIComponent(i)),c){var l=sessionStorage.getItem("sshInfo");if(l){var u=JSON.parse(l);t=u.hostname,s=u.port,a=u.username,n=u.password,o=u.command,r=u.privateKey,i=u.passphrase}}else if(!t||!a||!n&&!r){var h=sessionStorage.getItem("sshInfo");if(h){var p=JSON.parse(h);t=p.hostname,s=p.port,a=p.username,n=p.password,o=p.command,r=p.privateKey,i=p.passphrase}}t&&a&&(n||r)&&this.$store.commit("SET_SSH",{hostname:t,port:Number(s)||22,username:a,password:n,command:o,privateKey:r,passphrase:i})}}),Oe=(s("d75a"),Object(Y.a)(Le,(function(){var e=this._self._c;return e("div",{staticClass:"terminal-page"},[e("Terminal")],1)}),[],!1,null,"4edf7ad7",null).exports);a.default.use(me.a);var $e=new me.a({mode:"history",routes:[{path:"/",component:ve},{path:"/terminal",component:Oe}]});s("abb2");function Fe(e){"dark"===e?document.body.classList.add("dark-theme"):document.body.classList.remove("dark-theme"),localStorage.setItem("theme",e)}a.default.use(B),a.default.config.productionTip=!1,new a.default({el:"#app",i18n:ue,store:fe,router:$e,render:function(e){return e(Q)}}),Fe(localStorage.getItem("theme")||"light"),window.setTheme=Fe},"571b":function(e,t,s){},"58ef":function(e,t,s){"use strict";s("e06a")},"7e88":function(e,t,s){},"836a":function(e,t,s){"use strict";s("7e88")},ad04:function(e,t,s){},b20f:function(e,t,s){},d75a:function(e,t,s){"use strict";s("fa09")},e06a:function(e,t,s){},fa09:function(e,t,s){},feba:function(e,t,s){"use strict";s("571b")}});
//# sourceMappingURL=app.181c774e.js.map